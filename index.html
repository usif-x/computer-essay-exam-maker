<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Computer Essay Exam Maker</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- CodeMirror CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css"
    />

    <style>
      body {
        font-family: system-ui, -apple-system, sans-serif;
      }

      .code-content {
        direction: ltr;
        text-align: left;
      }

      .CodeMirror {
        height: 500px;
        border: 2px solid #e5e7eb;
        border-radius: 0.5rem;
        font-size: 14px;
        direction: ltr;
      }

      .CodeMirror-focused {
        border-color: #6366f1;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .streaming-text {
        animation: blink 1s infinite;
      }

      @keyframes blink {
        0%,
        50% {
          opacity: 1;
        }
        51%,
        100% {
          opacity: 0.5;
        }
      }

      .error-line {
        background-color: rgba(239, 68, 68, 0.1);
        border-left: 3px solid #ef4444;
        padding-left: 8px;
      }

      /* Responsive adjustments */
      @media (max-width: 640px) {
        .CodeMirror {
          height: 350px;
          font-size: 12px;
        }
      }

      @media (min-width: 641px) and (max-width: 1024px) {
        .CodeMirror {
          height: 450px;
          font-size: 13px;
        }
      }

      @media (min-width: 1280px) {
        .CodeMirror {
          height: 550px;
          font-size: 15px;
        }
      }

      /* Smooth transitions */
      * {
        transition-property: background-color, border-color, color, fill, stroke;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        transition-duration: 150ms;
      }

      /* Better scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div
      class="container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 lg:py-8 max-w-[1800px]"
    >
      <!-- Header -->
      <header class="bg-white rounded-lg shadow-lg p-4 sm:p-6 mb-4 sm:mb-6">
        <h1
          class="text-2xl sm:text-3xl lg:text-4xl font-bold text-indigo-600 mb-2"
        >
          Computer Essay Exam Maker
        </h1>
        <p class="text-sm sm:text-base text-gray-600">
          AI-Powered Python Code Practice & Review System
        </p>
      </header>

      <!-- Main Content -->
      <div class="grid grid-cols-1 xl:grid-cols-12 gap-4 sm:gap-6">
        <!-- Left Panel: Upload & Question -->
        <div class="xl:col-span-9 space-y-4 sm:space-y-6">
          <!-- PDF Upload Section -->
          <div
            id="uploadSection"
            class="bg-white rounded-lg shadow-lg p-4 sm:p-6"
          >
            <h2 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-4">
              üìö Study Material
            </h2>

            <!-- Pre-loaded Materials Selector -->
            <div>
              <label
                class="block text-gray-700 font-medium mb-2 text-sm sm:text-base"
              >
                Select Material:
              </label>
              <select
                id="materialSelect"
                class="w-full px-4 py-3 border-2 border-indigo-300 rounded-lg focus:outline-none focus:border-indigo-500 text-sm sm:text-base bg-white"
              >
                <option value="">-- Choose a material --</option>
                <option value="1">
                  Part 1: Introduction to Computers and Programming
                </option>
                <option value="2">
                  Part 2: Introduction to Computers and Programming
                </option>
                <option value="3">Introduction to Programming</option>
                <option value="all">üî• All Materials Combined</option>
              </select>
            </div>

            <div id="pdfStatus" class="mt-4 text-xs sm:text-sm"></div>
          </div>

          <!-- Question Display -->
          <div
            id="questionSection"
            class="bg-white rounded-lg shadow-lg p-4 sm:p-6 hidden"
          >
            <div
              class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4"
            >
              <h2 class="text-xl sm:text-2xl font-semibold text-gray-800">
                üìù Your Question
              </h2>
              <div class="flex flex-wrap gap-2 w-full sm:w-auto">
                <button
                  id="generateBtn"
                  class="flex-1 sm:flex-none bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 disabled:opacity-50 text-sm sm:text-base"
                  disabled
                >
                  Generate New Question
                </button>
                <button
                  id="harderBtn"
                  class="hidden flex-1 sm:flex-none bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 disabled:opacity-50 text-sm sm:text-base"
                >
                  üöÄ Make Harder
                </button>
              </div>
            </div>
            <div
              id="questionDisplay"
              class="bg-gradient-to-r from-indigo-50 to-blue-50 rounded-lg p-4 sm:p-6 mb-4 sm:mb-6"
            >
              <div class="streaming-text text-gray-500 text-sm sm:text-base">
                Generating question...
              </div>
            </div>

            <!-- Code Editor -->
            <div class="mb-4 sm:mb-6">
              <label
                class="block text-gray-700 font-semibold mb-2 text-base sm:text-lg"
                >Write Your Python Code:</label
              >
              <div id="codeMirrorContainer">
                <textarea id="codeEditor" class="hidden"></textarea>
              </div>
              <div
                class="flex flex-col sm:flex-row items-start sm:items-center justify-between mt-3 text-xs sm:text-sm text-gray-600 gap-2"
              >
                <div class="flex items-center gap-3 sm:gap-4">
                  <span id="lineCount" class="font-medium">Lines: 0</span>
                  <span id="charCount" class="font-medium">Characters: 0</span>
                </div>
                <div class="text-xs text-gray-500">
                  Press Ctrl+Space for autocomplete
                </div>
              </div>
            </div>

            <!-- Submit Button -->
            <button
              id="submitBtn"
              class="w-full bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded-lg font-semibold text-base sm:text-lg transition-all duration-200 disabled:opacity-50 shadow-md hover:shadow-lg"
              disabled
            >
              Submit for Review
            </button>
          </div>

          <!-- Review Results -->
          <div
            id="reviewSection"
            class="bg-white rounded-lg shadow-lg p-4 sm:p-6 hidden"
          >
            <h2
              class="text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6"
            >
              üéØ Review Results
            </h2>

            <!-- Score Display -->
            <div
              class="grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 mb-4 sm:mb-6"
            >
              <div
                class="bg-gradient-to-br from-purple-500 to-indigo-600 rounded-lg p-4 sm:p-5 text-white shadow-lg hover:shadow-xl transition-shadow duration-200"
              >
                <div class="text-xs sm:text-sm opacity-90">Score</div>
                <div
                  id="scoreDisplay"
                  class="text-3xl sm:text-4xl font-bold my-1"
                >
                  --
                </div>
                <div class="text-xs sm:text-sm opacity-90">out of 100</div>
              </div>
              <div
                class="bg-gradient-to-br from-blue-500 to-cyan-600 rounded-lg p-4 sm:p-5 text-white shadow-lg hover:shadow-xl transition-shadow duration-200"
              >
                <div class="text-xs sm:text-sm opacity-90">Quality</div>
                <div
                  id="qualityDisplay"
                  class="text-xl sm:text-2xl font-bold my-2 sm:my-3"
                >
                  --
                </div>
              </div>
              <div
                class="bg-gradient-to-br from-pink-500 to-rose-600 rounded-lg p-4 sm:p-5 text-white shadow-lg hover:shadow-xl transition-shadow duration-200"
              >
                <div class="text-xs sm:text-sm opacity-90">Errors Found</div>
                <div
                  id="errorCountDisplay"
                  class="text-3xl sm:text-4xl font-bold my-1"
                >
                  --
                </div>
              </div>
            </div>

            <!-- Detailed Feedback -->
            <div id="feedbackDisplay" class="space-y-3 sm:space-y-4">
              <!-- Will be populated by JS -->
            </div>

            <!-- Try Again Button -->
            <button
              id="tryAgainBtn"
              class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 px-6 rounded-lg font-semibold mt-4 sm:mt-6 transition-all duration-200 shadow-md hover:shadow-lg text-sm sm:text-base"
            >
              Try Another Question
            </button>
          </div>
        </div>

        <!-- Right Panel: Instructions & Tips -->
        <div class="xl:col-span-3 space-y-4 sm:space-y-6">
          <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6">
            <h3
              class="text-lg sm:text-xl font-semibold text-gray-800 mb-3 sm:mb-4"
            >
              üìñ How to Use
            </h3>
            <ol class="space-y-2 sm:space-y-3 text-gray-600 text-xs sm:text-sm">
              <li class="flex items-start">
                <span
                  class="bg-indigo-100 text-indigo-600 rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center mr-2 flex-shrink-0 font-semibold text-xs sm:text-sm"
                  >1</span
                >
                <span>Upload your study material (PDF file)</span>
              </li>
              <li class="flex items-start">
                <span
                  class="bg-indigo-100 text-indigo-600 rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center mr-2 flex-shrink-0 font-semibold text-xs sm:text-sm"
                  >2</span
                >
                <span
                  >Wait for AI to generate a question based on the content</span
                >
              </li>
              <li class="flex items-start">
                <span
                  class="bg-indigo-100 text-indigo-600 rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center mr-2 flex-shrink-0 font-semibold text-xs sm:text-sm"
                  >3</span
                >
                <span>Write your Python code solution</span>
              </li>
              <li class="flex items-start">
                <span
                  class="bg-indigo-100 text-indigo-600 rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center mr-2 flex-shrink-0 font-semibold text-xs sm:text-sm"
                  >4</span
                >
                <span>Submit and get instant AI-powered feedback</span>
              </li>
              <li class="flex items-start">
                <span
                  class="bg-indigo-100 text-indigo-600 rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center mr-2 flex-shrink-0 font-semibold text-xs sm:text-sm"
                  >5</span
                >
                <span>Review your mistakes and try again</span>
              </li>
            </ol>
          </div>

          <div
            class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg p-4 sm:p-6"
          >
            <h3
              class="text-lg sm:text-xl font-semibold text-green-800 mb-2 sm:mb-3"
            >
              üí° Tips for Success
            </h3>
            <ul
              class="space-y-1.5 sm:space-y-2 text-green-700 text-xs sm:text-sm"
            >
              <li class="flex items-start">
                <span class="mr-2">‚úì</span>
                <span>Write clean, readable code with proper indentation</span>
              </li>
              <li class="flex items-start">
                <span class="mr-2">‚úì</span>
                <span>Add comments to explain your logic</span>
              </li>
              <li class="flex items-start">
                <span class="mr-2">‚úì</span>
                <span>Test your code logic before submitting</span>
              </li>
              <li class="flex items-start">
                <span class="mr-2">‚úì</span>
                <span>Read the question carefully</span>
              </li>
              <li class="flex items-start">
                <span class="mr-2">‚úì</span>
                <span>Learn from the AI feedback</span>
              </li>
            </ul>
          </div>

          <div
            class="bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-lg p-4 sm:p-6"
          >
            <h3
              class="text-lg sm:text-xl font-semibold text-amber-800 mb-2 sm:mb-3"
            >
              ‚≠ê Quality Levels
            </h3>
            <div class="space-y-1.5 sm:space-y-2 text-xs sm:text-sm">
              <div class="flex items-center">
                <span class="bg-green-500 w-3 h-3 rounded-full mr-2"></span>
                <span class="text-gray-700"
                  ><strong>Good:</strong> No errors, excellent code</span
                >
              </div>
              <div class="flex items-center">
                <span class="bg-yellow-500 w-3 h-3 rounded-full mr-2"></span>
                <span class="text-gray-700"
                  ><strong>Not Bad:</strong> Has syntax errors but fixable</span
                >
              </div>
              <div class="flex items-center">
                <span class="bg-red-500 w-3 h-3 rounded-full mr-2"></span>
                <span class="text-gray-700"
                  ><strong>Bad:</strong> Major issues or incorrect logic</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="fixed top-4 right-4 space-y-2 z-50"></div>

    <!-- Scripts -->
    <!-- CodeMirror JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/selection/active-line.min.js"></script>

    <script src="assets/js/pdf-handler.js"></script>
    <script src="assets/js/ai-service.js"></script>
    <script src="assets/js/app.js"></script>
  </body>
</html>
